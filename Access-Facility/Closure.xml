<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="1abd9078-c605-4763-9ba0-fec2eb97aaa7" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Closure" searchProperties="true" timeout="0" maxResults="0" disabled="true" xmlns:con="http://eviware.com/soapui/config">
  <con:description>Test Case Name:


Description:


Expected Result:</con:description>
  <con:settings>
    <con:setting id="1abd9078-c605-4763-9ba0-fec2eb97aaa7fileName">Closure</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="datasource" name="UsernamePasswordDataSource" id="3bc66d83-72c6-4032-a43e-a46bed9f982a">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="Excel">
        <con:configuration>
          <file>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/UsernamePassword.xlsx</file>
          <worksheet>Sheet1</worksheet>
          <cell>A2</cell>
          <ignoreEmpty>false</ignoreEmpty>
          <evaluateFormulas>false</evaluateFormulas>
        </con:configuration>
      </con:dataSource>
      <con:shared>false</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>grant_type</con:property>
      <con:property>username</con:property>
      <con:property>password</con:property>
      <con:startRow/>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:failOnEmpty>true</con:failOnEmpty>
      <con:trimValues>true</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="UsernamePassword" id="64e20e13-666f-41ef-bfd7-e886c2ff484e">
    <con:settings/>
    <con:config>
      <script>//Get URL Encoded
def grant_type = context.expand( '${UsernamePasswordDataSource#grant_type}' )
def username = context.expand( '${UsernamePasswordDataSource#username}' )
def password = context.expand( '${UsernamePasswordDataSource#password}' )

//Build URLEncoded
//grant_type=password&amp;username=CP343094&amp;password=Vadyca!22
def URLEncoded = ('grant_type='+grant_type+'&amp;username='+username+'&amp;password='+password)
log.info(URLEncoded)
//Create variable 
testRunner.testCase.setPropertyValue( "URLEncoded", URLEncoded )</script>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="Token" id="6ce680e1-2110-4732-b8ca-969d90261070">
    <con:settings/>
    <con:config service="https://idp-non-prod.int.capinet" resourcePath="/token" methodName="Token" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="Token" id="3fff67e7-5a37-44b8-8893-cbce56d10cf0" mediaType="Form URL Encoded" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/x-www-form-urlencoded" xmlns="http://eviware.com/soapui/config"/></con:setting>
        </con:settings>
        <con:endpoint>https://idp-non-prod.int.capinet/auth/realms/DEV/protocol/openid-connect</con:endpoint>
        <con:request>${#TestCase#URLEncoded}</con:request>
        <con:originalUri>https://idp-non-prod.int.capinet/auth/realms/DEV/protocol/openid-connect/token</con:originalUri>
        <con:assertion type="JsonPath Existence Match" id="bc731ccc-e45b-4121-969b-7b4dde6be7e9" name="Check for existence of [access_token]">
          <con:configuration>
            <path>$['access_token']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username>Platform-DEV</con:username>
          <con:password>5d2448d6-205a-489a-937e-fa2479521bfd</con:password>
          <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
          <con:preemptive>true</con:preemptive>
          <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
          <con:authType>Preemptive</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:parameters/>
        <con:parameterOrder/>
        <con:environmentSpec>
          <con:entry environmentId="d762859b-28b7-4b5a-be3e-b89bb67042dc">
            <con:authProfile>Basic</con:authProfile>
            <con:username>Platform-DEV</con:username>
            <con:password>5d2448d6-205a-489a-937e-fa2479521bfd</con:password>
            <con:preemptive>true</con:preemptive>
          </con:entry>
          <con:entry environmentId="c6d10c3f-13fd-496d-a352-d5e1b3ffb3e4">
            <con:authProfile>Basic</con:authProfile>
            <con:username>Platform-INT</con:username>
            <con:password>3a6198ea-eed5-43b2-bee2-a5a4895096ec</con:password>
            <con:preemptive>true</con:preemptive>
          </con:entry>
          <con:entry environmentId="abe22d3f-c611-48a2-aa3a-bbb3916687f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="89bfff1c-d314-464e-8dc2-7c368a0011af">
            <con:authProfile>Basic</con:authProfile>
            <con:username>Platform-DEV</con:username>
            <con:password>5d2448d6-205a-489a-937e-fa2479521bfd</con:password>
            <con:preemptive>true</con:preemptive>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="TransferToken" id="094d76f3-95c4-4a27-85e4-1e3b61eed39f">
    <con:settings/>
    <con:config>
      <script>//Get token value
def token = context.expand( '${Token#Response#$[\'access_token\']}' )
return 'Bearer ' + token</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="DataSource" id="5a24d96e-c5b6-497d-be14-95f2d8f5219a">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="Excel">
        <con:configuration>
          <file>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/CloseAF/1.ProductInfo.xlsx</file>
          <worksheet>Sheet1</worksheet>
          <cell>E1</cell>
          <ignoreEmpty>false</ignoreEmpty>
          <evaluateFormulas>false</evaluateFormulas>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>customerNumber</con:property>
      <con:property>transferAmount</con:property>
      <con:property>statementDescription</con:property>
      <con:property>paymentOptions</con:property>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:restartOnRun>true</con:restartOnRun>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="ProductInfo" id="2fbe2da3-0c2c-4781-acc1-e333248e4d8e">
    <con:settings/>
    <con:config service="https://onramp-int.int.capinet" resourcePath="/access-facility/productInfo" methodName="ProductInfo" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="ProductInfo" id="25faacab-7612-4435-99a3-007ff47aca74" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="sourceSystemIdentifier" value="USSD" xmlns="http://eviware.com/soapui/config"/></con:setting>
          <con:setting id="discardResponse">false</con:setting>
        </con:settings>
        <con:endpoint>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility</con:endpoint>
        <con:request>{\r
   "accountNumber" : "",\r
   "transferAmount" : ""\r
}</con:request>
        <con:originalUri>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility/transfer</con:originalUri>
        <con:assertion type="JsonPath Existence Match" id="d66da373-023f-449b-9b61-b19efb12c2a6" name="Check for existence of [accountNumber]">
          <con:configuration>
            <path>$['accountNumber']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="d0be1a4b-0752-4283-bda3-0d44f9b5abf1" name="Check for existence of [approvedDate]">
          <con:configuration>
            <path>$['approvedDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="0bac3ac3-d10d-4de9-a097-ff9ed9dfef04" name="Check for existence of [availableLimit]">
          <con:configuration>
            <path>$['availableLimit']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="97955657-c446-4947-8a76-9dff6086aba5" name="Check for existence of [interestRateYearly]">
          <con:configuration>
            <path>$['interestRateYearly']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="2b469790-cc56-4d0e-8974-f02d9bf9cc47" name="Check for existence of [accountBalance]">
          <con:configuration>
            <path>$['accountBalance']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="17f0f37d-5a69-44c9-ad1c-8e809851ef11" name="Check for existence of [availableToTransfer]">
          <con:configuration>
            <path>$['availableToTransfer']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="b1695fd5-c56f-41b2-b68b-5077e9bce9ad" name="Check for existence of [remainingTerm]">
          <con:configuration>
            <path>$['remainingTerm']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="4307ab89-cf5a-4a71-b9a5-826e24002bc6" name="Check for existence of [nextInstalmentDue]">
          <con:configuration>
            <path>$['nextInstalmentDue']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="f253700a-0421-4e34-b412-0d4bb773b308" name="Check for existence of [nextInstalmentDate]">
          <con:configuration>
            <path>$['nextInstalmentDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="0751e283-a671-4474-a8a7-c2a646bd6631" name="Check for existence of [autoLimitIncrease]">
          <con:configuration>
            <path>$['autoLimitIncrease']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="383e0422-831b-482f-ba11-b24dc6c0bc56" name="Check for existence of [monthlyServiceFee]">
          <con:configuration>
            <path>$['monthlyServiceFee']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="737626d8-ec94-49ac-8340-621b714ba2fb" name="Check for existence of [minimumTerm]">
          <con:configuration>
            <path>$['minimumTerm']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="3284d06a-3ee9-49bc-8bf9-6771dc5f3fa8" name="Check for existence of [maximumTerm]">
          <con:configuration>
            <path>$['maximumTerm']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="ab1984d2-611f-4f8b-8b3f-4fc6dfd60e81" name="Check for existence of [minimumTransferAmount]">
          <con:configuration>
            <path>$['minimumTransferAmount']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="40715926-3258-4a50-9b54-d628c4877084" name="Check for existence of [maximumRepayment]">
          <con:configuration>
            <path>$['maximumRepayment']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="20ee2386-3fe6-4085-b00b-e7f1571bfbd4" name="Check for existence of [termBasis]">
          <con:configuration>
            <path>$['termBasis']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="cb110b71-60e9-46e8-be24-3e1b235f5e92" name="Check for existence of [lastArrearsDate]">
          <con:configuration>
            <path>$['lastArrearsDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="dee5ccc1-0129-4fec-80af-e3b707c222d3" name="Check for existence of [decemberArrears]">
          <con:configuration>
            <path>$['decemberArrears']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="88740023-2d4c-4d9a-9e32-860b4e88afdf" name="Check for existence of [totalArrearsPayable]">
          <con:configuration>
            <path>$['totalArrearsPayable']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="9e16e8a5-4c42-4a40-abd8-2c2160e133f0" name="Check for existence of [productInsurance]">
          <con:configuration>
            <path>$['productInsurance']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="${TransferToken#result}"/>
          <con:entry key="customerNumber" value="${DataSource#customerNumber}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>customerNumber</con:entry>
          <con:entry>Authorization</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="abe22d3f-c611-48a2-aa3a-bbb3916687f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="89bfff1c-d314-464e-8dc2-7c368a0011af">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="ProductInfoSinkData" id="deecc65e-5907-4f88-a5df-da3a7ccc7c83">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.JsonUtil

//Clear property values in datasink
data = context.testCase.getTestStepByName("ProductInfoSaveResponse");
String[] propToRemove = new String[data.getPropertyCount()];
propToRemove = data.getPropertyNames();
for ( int i = 0 ; i &lt; propToRemove.size(); i++ ){
    data.removeProperty( propToRemove[i] );
}

//accountNumber
def accountNumber = context.expand( '${ProductInfo#Response#$[\'accountNumber\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("accountNumber", accountNumber.toString()) 

//approvedDate
def approvedDate = context.expand( '${ProductInfo#Response#$[\'approvedDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("approvedDate", approvedDate.toString())

//availableLimit
def availableLimit = context.expand( '${ProductInfo#Response#$[\'availableLimit\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("availableLimit", availableLimit.toString())

//interestRateYearly
def interestRateYearly = context.expand( '${ProductInfo#Response#$[\'interestRateYearly\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("interestRateYearly", interestRateYearly.toString())

//accountBalance
def accountBalance = context.expand( '${ProductInfo#Response#$[\'accountBalance\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("accountBalance", accountBalance.toString())

//availableToTransfer
def availableToTransfer = context.expand( '${ProductInfo#Response#$[\'availableToTransfer\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("availableToTransfer", availableToTransfer.toString())

//remainingTerm
def remainingTerm = context.expand( '${ProductInfo#Response#$[\'remainingTerm\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("remainingTerm", remainingTerm.toString())

//nextInstalmentDue
def nextInstalmentDue = context.expand( '${ProductInfo#Response#$[\'nextInstalmentDue\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("nextInstalmentDue", nextInstalmentDue.toString())

//nextInstalmentDate
def nextInstalmentDate = context.expand( '${ProductInfo#Response#$[\'nextInstalmentDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("nextInstalmentDate", nextInstalmentDate.toString())

//autoLimitIncrease
def autoLimitIncrease = context.expand( '${ProductInfo#Response#$[\'autoLimitIncrease\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("autoLimitIncrease", autoLimitIncrease.toString())

//monthlyServiceFee
def monthlyServiceFee = context.expand( '${ProductInfo#Response#$[\'monthlyServiceFee\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("monthlyServiceFee", monthlyServiceFee.toString())

//minimumTerm
def minimumTerm = context.expand( '${ProductInfo#Response#$[\'minimumTerm\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("minimumTerm", minimumTerm.toString())

//maximumTerm
def maximumTerm = context.expand( '${ProductInfo#Response#$[\'maximumTerm\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("maximumTerm", maximumTerm.toString())

//maximumRepayment
def maximumRepayment = context.expand( '${ProductInfo#Response#$[\'maximumRepayment\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("maximumRepayment", maximumRepayment.toString())

//termBasis
def termBasis = context.expand( '${ProductInfo#Response#$[\'termBasis\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("termBasis", termBasis.toString())

//lastArrearsDate
def lastArrearsDate = context.expand( '${ProductInfo#Response#$[\'lastArrearsDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("lastArrearsDate", lastArrearsDate.toString())

//decemberArrears
def decemberArrears = context.expand( '${ProductInfo#Response#$[\'decemberArrears\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("decemberArrears", decemberArrears.toString())

//totalArrearsPayable
def totalArrearsPayable = context.expand( '${ProductInfo#Response#$[\'totalArrearsPayable\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("totalArrearsPayable", totalArrearsPayable.toString())

//productInsurance
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("productInsurance", "-".toString())

//insuranceExpiry
def insuranceExpiry = context.expand( '${ProductInfo#Response#$[\'productInsurance\'][\'insuranceExpiry\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("insuranceExpiry", insuranceExpiry.toString()) 

//insuranceDeathRate
def insuranceDeathRate = context.expand( '${ProductInfo#Response#$[\'productInsurance\'][\'insuranceDeathRate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("insuranceDeathRate", insuranceDeathRate.toString()) 

//insuranceDisabilityRate
def insuranceDisabilityRate = context.expand( '${ProductInfo#Response#$[\'productInsurance\'][\'insuranceDisabilityRate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("insuranceDisabilityRate", insuranceDisabilityRate.toString()) 

//insuranceRetrenchmentRate
def insuranceRetrenchmentRate = context.expand( '${ProductInfo#Response#$[\'productInsurance\'][\'insuranceRetrenchmentRate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("insuranceRetrenchmentRate", insuranceRetrenchmentRate.toString()) 

//insuranceOption
def insuranceOption = context.expand( '${ProductInfo#Response#$[\'productInsurance\'][\'insuranceOption\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("insuranceOption", insuranceOption.toString())

//clientName
def clientName = context.expand( '${ProductInfo#Response#$[\'clientName\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("clientName", clientName.toString()) 

//fixedInitiationFee
def fixedInitiationFee = context.expand( '${ProductInfo#Response#$[\'fixedInitiationFee\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("fixedInitiationFee", fixedInitiationFee.toString()) 

//interestRateMargin
def interestRateMargin = context.expand( '${ProductInfo#Response#$[\'interestRateMargin\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("interestRateMargin", interestRateMargin.toString()) 

//maxInitiationFee
def maxInitiationFee = context.expand( '${ProductInfo#Response#$[\'maxInitiationFee\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("maxInitiationFee", maxInitiationFee.toString())

//interestRateType
def interestRateType = context.expand( '${ProductInfo#Response#$[\'interestRateType\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("interestRateType", interestRateType.toString()) 

//initiationFee1
def initiationFee1 = context.expand( '${ProductInfo#Response#$[\'initiationFee1\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("initiationFee1", initiationFee1.toString()) 

//initiationFee2
def initiationFee2 = context.expand( '${ProductInfo#Response#$[\'initiationFee2\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("initiationFee2", initiationFee2.toString()) 

//cummulativeTransferTotal
def cummulativeTransferTotal = context.expand( '${ProductInfo#Response#$[\'cummulativeTransferTotal\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("cummulativeTransferTotal", cummulativeTransferTotal.toString()) 

//nonUsageServiceFee
def nonUsageServiceFee = context.expand( '${ProductInfo#Response#$[\'nonUsageServiceFee\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("nonUsageServiceFee", nonUsageServiceFee.toString()) 

//initiationFeeBracketAmt
def initiationFeeBracketAmt = context.expand( '${ProductInfo#Response#$[\'initiationFeeBracketAmt\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("initiationFeeBracketAmt", initiationFeeBracketAmt.toString()) 

//riskCategory
def riskCategory = context.expand( '${ProductInfo#Response#$[\'riskCategory\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("riskCategory", riskCategory.toString()) 

//minimumTransferAmount
def minimumTransferAmount = context.expand( '${ProductInfo#Response#$[\'minimumTransferAmount\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("minimumTransferAmount", minimumTransferAmount.toString()) 

//contractedCapital
def contractedCapital = context.expand( '${ProductInfo#Response#$[\'contractedCapital\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("contractedCapital", contractedCapital.toString()) 

//contractedTerm
def contractedTerm = context.expand( '${ProductInfo#Response#$[\'contractedTerm\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("contractedTerm", contractedTerm.toString()) 

//contractCapitalDate
def contractCapitalDate = context.expand( '${ProductInfo#Response#$[\'contractCapitalDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("contractCapitalDate", contractCapitalDate.toString()) 

//collectionDate
def collectionDate = context.expand( '${ProductInfo#Response#$[\'collectionDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("collectionDate", collectionDate.toString()) 

//contractedRepayment
def contractedRepayment = context.expand( '${ProductInfo#Response#$[\'contractedRepayment\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("contractedRepayment", contractedRepayment.toString()) 

//suspensiveCondition
def suspensiveCondition = context.expand( '${ProductInfo#Response#$[\'suspensiveCondition\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("suspensiveCondition", suspensiveCondition.toString()) 
if(suspensiveCondition.equals("Y")) {
	log.info "FAIL: Client has a suspensive condition."
	testRunner.fail(testRunner.testCase.name + " Failed: Client has a suspensive condition.")
}

//ccsStatus
def ccsStatus = context.expand( '${ProductInfo#Response#$[\'ccsStatus\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("ccsStatus", ccsStatus.toString()) 

//deActiveDate
def deActiveDate = context.expand( '${ProductInfo#Response#$[\'deActiveDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("deActiveDate", deActiveDate.toString()) 

//suspensiveDate
def suspensiveDate = context.expand( '${ProductInfo#Response#$[\'suspensiveDate\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("suspensiveDate", suspensiveDate.toString()) 

//loanStop
def loanStop = context.expand( '${ProductInfo#Response#$[\'loanStop\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("loanStop", loanStop.toString()) 

//clientUnderAdminstration
def clientUnderAdminstration = context.expand( '${ProductInfo#Response#$[\'clientUnderAdminstration\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("clientUnderAdminstration", clientUnderAdminstration.toString()) 

//afInArrears
def afInArrears = context.expand( '${ProductInfo#Response#$[\'afInArrears\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("afInArrears", afInArrears.toString()) 

//unEmployed
def unEmployed = context.expand( '${ProductInfo#Response#$[\'unEmployed\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("unEmployed", unEmployed.toString()) 

//debtRestructuring
def debtRestructuring = context.expand( '${ProductInfo#Response#$[\'debtRestructuring\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("debtRestructuring", debtRestructuring.toString()) 

//otherAccountInArrears
def otherAccountInArrears = context.expand( '${ProductInfo#Response#$[\'otherAccountInArrears\']}' )
testRunner.testCase.testSteps["ProductInfoSaveResponse"].setPropertyValue("otherAccountInArrears", otherAccountInArrears.toString())</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasink" name="ProductInfoSaveResponse" id="a4893633-5737-40d2-bbc6-d2a73bd9c17b">
    <con:settings/>
    <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSink type="Excel">
        <con:configuration>
          <file/>
          <outfile>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/CloseAF/1.ProductInfoResults.xlsx</outfile>
          <worksheet>Sheet1</worksheet>
          <cell>E2</cell>
          <evaluateFormulas>false</evaluateFormulas>
          <append>false</append>
        </con:configuration>
      </con:dataSink>
      <con:shared>false</con:shared>
      <con:properties>
        <con:property>
          <con:name>accountNumber</con:name>
          <con:value>1688735354</con:value>
        </con:property>
        <con:property>
          <con:name>approvedDate</con:name>
          <con:value>2020-01-27</con:value>
        </con:property>
        <con:property>
          <con:name>availableLimit</con:name>
          <con:value>200000.0</con:value>
        </con:property>
        <con:property>
          <con:name>interestRateYearly</con:name>
          <con:value>18.0</con:value>
        </con:property>
        <con:property>
          <con:name>accountBalance</con:name>
          <con:value>169207.0</con:value>
        </con:property>
        <con:property>
          <con:name>availableToTransfer</con:name>
          <con:value>30793.0</con:value>
        </con:property>
        <con:property>
          <con:name>remainingTerm</con:name>
          <con:value>48</con:value>
        </con:property>
        <con:property>
          <con:name>nextInstalmentDue</con:name>
          <con:value>5511.41</con:value>
        </con:property>
        <con:property>
          <con:name>nextInstalmentDate</con:name>
          <con:value>2020-02-14</con:value>
        </con:property>
        <con:property>
          <con:name>autoLimitIncrease</con:name>
          <con:value>N</con:value>
        </con:property>
        <con:property>
          <con:name>monthlyServiceFee</con:name>
          <con:value>69.0</con:value>
        </con:property>
        <con:property>
          <con:name>minimumTerm</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>maximumTerm</con:name>
          <con:value>48</con:value>
        </con:property>
        <con:property>
          <con:name>maximumRepayment</con:name>
          <con:value>6368.95</con:value>
        </con:property>
        <con:property>
          <con:name>termBasis</con:name>
          <con:value>MONTHLY</con:value>
        </con:property>
        <con:property>
          <con:name>lastArrearsDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>decemberArrears</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>totalArrearsPayable</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>productInsurance</con:name>
          <con:value>-</con:value>
        </con:property>
        <con:property>
          <con:name>insuranceExpiry</con:name>
          <con:value>2020-05-04</con:value>
        </con:property>
        <con:property>
          <con:name>insuranceDeathRate</con:name>
          <con:value>1.0</con:value>
        </con:property>
        <con:property>
          <con:name>insuranceDisabilityRate</con:name>
          <con:value>1.0</con:value>
        </con:property>
        <con:property>
          <con:name>insuranceRetrenchmentRate</con:name>
          <con:value>1.0</con:value>
        </con:property>
        <con:property>
          <con:name>insuranceOption</con:name>
          <con:value>CAPITEC_BANK_CREDIT_INSURANCE</con:value>
        </con:property>
        <con:property>
          <con:name>clientName</con:name>
          <con:value>MRS JENNIFER MIENIES                            J</con:value>
        </con:property>
        <con:property>
          <con:name>fixedIntiationFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>interestRateMargin</con:name>
          <con:value>3.0</con:value>
        </con:property>
        <con:property>
          <con:name>maxIntiationFee</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>interestRateType</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>initiationFee1</con:name>
          <con:value>17.25</con:value>
        </con:property>
        <con:property>
          <con:name>initiationFee2</con:name>
          <con:value>11.5</con:value>
        </con:property>
        <con:property>
          <con:name>cummulativeTransferTotal</con:name>
          <con:value>188000.0</con:value>
        </con:property>
        <con:property>
          <con:name>nonUsageServiceFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>initiationFeeBracketAmt</con:name>
          <con:value>1300.0</con:value>
        </con:property>
        <con:property>
          <con:name>riskCategory</con:name>
          <con:value>XXX</con:value>
        </con:property>
        <con:property>
          <con:name>minimumTransferAmount</con:name>
          <con:value>4000.0</con:value>
        </con:property>
        <con:property>
          <con:name>contractedCapital</con:name>
          <con:value>173207.0</con:value>
        </con:property>
        <con:property>
          <con:name>contractedTerm</con:name>
          <con:value>47</con:value>
        </con:property>
        <con:property>
          <con:name>contractCapitalDate</con:name>
          <con:value>2020-02-13</con:value>
        </con:property>
        <con:property>
          <con:name>collectionDate</con:name>
          <con:value>2020-02-14</con:value>
        </con:property>
        <con:property>
          <con:name>contractedRepayment</con:name>
          <con:value>5299.77</con:value>
        </con:property>
        <con:property>
          <con:name>suspensiveCondition</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>ccsStatus</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>deActiveDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>suspensiveDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>loanStop</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>clientUnderAdminstration</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>afInArrears</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>unEmployed</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>debtRestructuring</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>otherAccountInArrears</con:name>
          <con:value/>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="Operations(Payment)" id="dc60d18c-eaea-4a62-bb7b-2e94fe9b02bf">
    <con:settings/>
    <con:config service="https://onramp-int.int.capinet" resourcePath="/access-facility/operations" methodName="Operations" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="Operations(Payment)" id="4da46116-2d86-4ebf-9368-58f74d8456fd" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="${TransferToken#result}"/>
  &lt;con:entry key="sourceSystemIdentifier" value="USSD"/>
&lt;/xml-fragment></con:setting>
        </con:settings>
        <con:endpoint>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility</con:endpoint>
        <con:request>{\r
   "accountNumber" : "",\r
   "transferAmount" : ""\r
}</con:request>
        <con:originalUri>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility/transfer</con:originalUri>
        <con:assertion type="JsonPath Existence Match" id="d69098ec-8b92-43ce-a428-e44332a32664" name="Check for existence of [loanBalance]">
          <con:configuration>
            <path>$['loanBalance']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="fc03a275-5768-4ebe-bf82-45aec7cb1256" name="Check for existence of [originalLimit]">
          <con:configuration>
            <path>$['originalLimit']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="d9b196bd-eae4-4059-a588-83cb8f6f1c68" name="Check for existence of [currentInstalmentDue]">
          <con:configuration>
            <path>$['currentInstalmentDue']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="b05264b4-9b2c-4ce0-ad9d-e5151d59a41f" name="Check for existence of [currentInstalmentDate]">
          <con:configuration>
            <path>$['currentInstalmentDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="8415f4d5-c9e5-43e3-9aba-924c15d55297" name="Check for existence of [currentNoOfInstalment]">
          <con:configuration>
            <path>$['currentNoOfInstalment']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="b80121fb-7712-4386-9afc-0a3d3d08a431" name="Check for existence of [followingInstalmentDue]">
          <con:configuration>
            <path>$['followingInstalmentDue']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="eaab4e05-7159-476f-b854-dea4dc41209f" name="Check for existence of [followingInstalmentDate]">
          <con:configuration>
            <path>$['followingInstalmentDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="48911d9b-4d80-4953-b700-a5391c3d59d2" name="Check for existence of [followingNoOfInstalment]">
          <con:configuration>
            <path>$['followingNoOfInstalment']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="c647bbd7-089d-489c-82cb-4688295d2ba2" name="Check for existence of [operatableAccount]">
          <con:configuration>
            <path>$['operatableAccount']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="operationIdentifier" value="payment"/>
          <con:entry key="accountNumber" value="${ProductInfo#Response#$['accountNumber']}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>accountNumber</con:entry>
          <con:entry>operationIdentifier</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="abe22d3f-c611-48a2-aa3a-bbb3916687f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="89bfff1c-d314-464e-8dc2-7c368a0011af">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="Operations(Payment)SinkData" id="7068a677-83c1-4303-9072-4c43a0ada281">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.JsonUtil

//Clear property values in datasink
data = context.testCase.getTestStepByName("Operations(Payment)SaveResponse");
String[] propToRemove = new String[data.getPropertyCount()];
propToRemove = data.getPropertyNames();
for ( int i = 0 ; i &lt; propToRemove.size(); i++ ){
    data.removeProperty( propToRemove[i] );
}

//loanBalance
def loanBalance = context.expand( '${Operations(Payment)#Response#$[\'loanBalance\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("loanBalance", loanBalance.toString()) 

//originalLimit
def originalLimit = context.expand( '${Operations(Payment)#Response#$[\'originalLimit\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("originalLimit", originalLimit.toString())

//currentInstalmentDue
def currentInstalmentDue = context.expand( '${Operations(Payment)#Response#$[\'currentInstalmentDue\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("currentInstalmentDue", currentInstalmentDue.toString())

//currentInstalmentDate
def currentInstalmentDate = context.expand( '${Operations(Payment)#Response#$[\'currentInstalmentDate\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("currentInstalmentDate", currentInstalmentDate.toString())

//currentNoOfInstalment
def currentNoOfInstalment = context.expand( '${Operations(Payment)#Response#$[\'currentNoOfInstalment\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("currentNoOfInstalment", currentNoOfInstalment.toString())

//followingInstalmentDue
def followingInstalmentDue = context.expand( '${Operations(Payment)#Response#$[\'followingInstalmentDue\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("followingInstalmentDue", followingInstalmentDue.toString())

//followingInstalmentDate
def followingInstalmentDate = context.expand( '${Operations(Payment)#Response#$[\'followingInstalmentDate\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("followingInstalmentDate", followingInstalmentDate.toString())

//followingNoOfInstalment
def followingNoOfInstalment = context.expand( '${Operations(Payment)#Response#$[\'followingNoOfInstalment\']}' )
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("followingNoOfInstalment", followingNoOfInstalment.toString())

//operatableAccount
testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("operatableAccount", "-".toString()) 
def Records = context.expand( '${Operations(Payment)#Response#$[\'operatableAccount\']}' )
//Records is now a string of all your items in the array
def RecordsArray = JsonUtil.parseTrimmedText(Records );
//Convereted back to an arry
def n = RecordsArray.size()
//Count how many records items  there are in the array
for (int i=0; i&lt; n; i=i+1){
	//Create a for loop to go through all the elements of the array
	def accountName = context.expand( '${Operations(Payment)#Response#$[\'operatableAccount\']['+i+'][\'accountName\']}' )
	def accountNumber = context.expand( '${Operations(Payment)#Response#$[\'operatableAccount\']['+i+'][\'accountNumber\']}' )
	//Log accountName
	testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("accountName"+i, accountName.toString()) 
	//Log accountNumber
	testRunner.testCase.testSteps["Operations(Payment)SaveResponse"].setPropertyValue("accountNumber"+i, accountNumber.toString()) 
}</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasink" name="Operations(Payment)SaveResponse" id="5ae6b813-75b7-4014-8893-56608f045da2">
    <con:settings/>
    <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSink type="Excel">
        <con:configuration>
          <file/>
          <outfile>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/CloseAF/2.Operations(Payment)Results.xlsx</outfile>
          <worksheet>Sheet1</worksheet>
          <cell>E2</cell>
          <evaluateFormulas>false</evaluateFormulas>
          <append>false</append>
        </con:configuration>
      </con:dataSink>
      <con:shared>false</con:shared>
      <con:properties>
        <con:property>
          <con:name>loanBalance</con:name>
          <con:value>169207.0</con:value>
        </con:property>
        <con:property>
          <con:name>originalLimit</con:name>
          <con:value>200000.0</con:value>
        </con:property>
        <con:property>
          <con:name>currentInstalmentDue</con:name>
          <con:value>5511.41</con:value>
        </con:property>
        <con:property>
          <con:name>currentInstalmentDate</con:name>
          <con:value>2020-02-14</con:value>
        </con:property>
        <con:property>
          <con:name>currentNoOfInstalment</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>followingInstalmentDue</con:name>
          <con:value>5299.77</con:value>
        </con:property>
        <con:property>
          <con:name>followingInstalmentDate</con:name>
          <con:value>2020-03-13</con:value>
        </con:property>
        <con:property>
          <con:name>followingNoOfInstalment</con:name>
          <con:value>47</con:value>
        </con:property>
        <con:property>
          <con:name>operatableAccount</con:name>
          <con:value>-</con:value>
        </con:property>
        <con:property>
          <con:name>accountName0</con:name>
          <con:value>SAVINGS ACCOUNT</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber0</con:name>
          <con:value>1110040871</con:value>
        </con:property>
        <con:property>
          <con:name>accountName1</con:name>
          <con:value>PRINCESS</con:value>
        </con:property>
        <con:property>
          <con:name>accountNumber1</con:name>
          <con:value>1650610104</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="SettlementInfo" id="c915e214-b8b7-4b03-b842-86f7f665652a">
    <con:settings/>
    <con:config service="https://onramp-int.int.capinet" resourcePath="/account/settlementInfo" methodName="SettlementInfo" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="SettlementInfo" id="e3e23ea5-7a1a-49fd-ae51-a433b78c894a" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="${TransferToken#result}"/>
  &lt;con:entry key="sourceSystemIdentifier" value="USSD"/>
&lt;/xml-fragment></con:setting>
        </con:settings>
        <con:endpoint>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility</con:endpoint>
        <con:request>{
	"accountNo":
	"customerNo":
	"currentSettlementAmount":
	"settlementDate":
	"maxSettlementAmount":
}</con:request>
        <con:originalUri>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility/transfer</con:originalUri>
        <con:assertion type="JsonPath Existence Match" id="9811cfd1-6d6d-4d53-9648-32eb8def4d10" name="Check for existence of [accountNo]">
          <con:configuration>
            <path>$['accountNo']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="b4464ca6-9415-4ba5-a377-feffa4000a04" name="Check for existence of [currency]">
          <con:configuration>
            <path>$['currency']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="260cfc9c-6372-4ecf-a443-336f8acd171d" name="Check for existence of [customerNo]">
          <con:configuration>
            <path>$['customerNo']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="b2aaab35-d502-47d6-afc2-4db9cbf583e8" name="Check for existence of [insDescription]">
          <con:configuration>
            <path>$['insDescription']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="7bb6a3d9-7d56-40e6-bc55-b5b7c3ba97e0" name="Check for existence of [dischargeRef]">
          <con:configuration>
            <path>$['dischargeRef']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="5b406f60-72ae-4780-ae80-79f4f9779a23" name="Check for existence of [accountName]">
          <con:configuration>
            <path>$['accountName']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="4c6f9a01-8c64-41d8-a505-84a6fd7abdfd" name="Check for existence of [customerName]">
          <con:configuration>
            <path>$['customerName']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="e174bdbd-e7c5-4a24-b7fe-3f742e224ed8" name="Check for existence of [address]">
          <con:configuration>
            <path>$['address']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="c6d410a5-99a2-4830-a589-f5877c763cee" name="Check for existence of [postalCode]">
          <con:configuration>
            <path>$['postalCode']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="e3966f3e-0208-4e78-bc7d-3b737e064ca6" name="Check for existence of [clearedBalance]">
          <con:configuration>
            <path>$['clearedBalance']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="a5ed7032-a8b6-4eab-827d-771eec0ff7de" name="Check for existence of [unEarnedIntRebate]">
          <con:configuration>
            <path>$['unEarnedIntRebate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="ce70fe3f-a53d-47ee-af08-7fc49e3acd82" name="Check for existence of [chequeBalance]">
          <con:configuration>
            <path>$['chequeBalance']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="e7c9c81f-ac20-4dab-8d99-b7f09b713f3b" name="Check for existence of [sharedRefund]">
          <con:configuration>
            <path>$['sharedRefund']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="c9ce18ba-9c55-409b-820f-552ab2673a6d" name="Check for existence of [sharedIntRefund]">
          <con:configuration>
            <path>$['sharedIntRefund']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="db092b65-9117-466b-9725-b68496170dff" name="Check for existence of [accruedInterest]">
          <con:configuration>
            <path>$['accruedInterest']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="051fa1b0-d50c-4016-a9b9-e1f1ac81a073" name="Check for existence of [intReliefSubsidy]">
          <con:configuration>
            <path>$['intReliefSubsidy']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="379c765f-9307-4d86-bc22-7748610c51dd" name="Check for existence of [inflationAmount]">
          <con:configuration>
            <path>$['inflationAmount']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="006a3d86-6042-4ac9-9a11-11d6b15bc0d7" name="Check for existence of [accruedFees]">
          <con:configuration>
            <path>$['accruedFees']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="f4d8c5af-65ae-470c-b1f5-8c184531bef6" name="Check for existence of [arrrearsPenalty]">
          <con:configuration>
            <path>$['arrrearsPenalty']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="cd715f3b-ea21-4b6c-abd0-198f159cf1d4" name="Check for existence of [miscDebts]">
          <con:configuration>
            <path>$['miscDebts']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="6d76e101-80f7-4801-a57c-eb61f969ef81" name="Check for existence of [dischargeFee]">
          <con:configuration>
            <path>$['dischargeFee']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="ac05b202-fd76-4d07-b488-e9fa4bbc07bf" name="Check for existence of [dischargeTax]">
          <con:configuration>
            <path>$['dischargeTax']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="29a2d7fb-7369-40e1-b5e8-d287fbc5e82c" name="Check for existence of [terminationFee]">
          <con:configuration>
            <path>$['terminationFee']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="c42c1fa4-2c13-40ca-9090-837ec55eb8d6" name="Check for existence of [trmnStartDate]">
          <con:configuration>
            <path>$['trmnStartDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="f39250c7-9aec-4492-b2ca-a04ea73337df" name="Check for existence of [trmnEndDate]">
          <con:configuration>
            <path>$['trmnEndDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="f3cafafd-0a38-4daf-bbc3-f4e51db2f3d8" name="Check for existence of [currentSettlementAmount]">
          <con:configuration>
            <path>$['currentSettlementAmount']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="ee917ae7-06d5-4547-a800-67526f692569" name="Check for existence of [settlementDate]">
          <con:configuration>
            <path>$['settlementDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="93c2f550-4b02-4f90-982f-cebb360ca96e" name="Check for existence of [maxSettlementAmount]">
          <con:configuration>
            <path>$['maxSettlementAmount']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Existence Match" id="056720f5-f100-4b23-a4b1-9dd125ac6f66" name="Check for existence of [expiryDate]">
          <con:configuration>
            <path>$['expiryDate']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <entry key="accountNumber" value="${ProductInfo#Response#$['accountNumber']}" xmlns="http://eviware.com/soapui/config"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>accountNumber</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="abe22d3f-c611-48a2-aa3a-bbb3916687f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="89bfff1c-d314-464e-8dc2-7c368a0011af">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="SettlementInfoSinkData" id="2a39a051-6e91-48d3-8978-ce6b07eebe91">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.JsonUtil

//Clear property values in datasink
data = context.testCase.getTestStepByName("SettlementInfoSaveResponse");
String[] propToRemove = new String[data.getPropertyCount()];
propToRemove = data.getPropertyNames();
for ( int i = 0 ; i &lt; propToRemove.size(); i++ ){
    data.removeProperty( propToRemove[i] );
}

//accountNo
def accountNo = context.expand( '${SettlementInfo#Response#$[\'accountNo\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accountNo", accountNo.toString()) 

//currency
def currency = context.expand( '${SettlementInfo#Response#$[\'currency\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("currency", currency.toString())

//customerNo
def customerNo = context.expand( '${SettlementInfo#Response#$[\'customerNo\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("customerNo", customerNo.toString())

//insDescription
def insDescription = context.expand( '${SettlementInfo#Response#$[\'insDescription\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("insDescription", insDescription.toString())

//dischargeRef
def dischargeRef = context.expand( '${SettlementInfo#Response#$[\'dischargeRef\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeRef", dischargeRef.toString())

//accountName
def accountName = context.expand( '${SettlementInfo#Response#$[\'accountName\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accountName", accountName.toString())

//customerName
def customerName = context.expand( '${SettlementInfo#Response#$[\'customerName\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("customerName", customerName.toString())

//address
def address = context.expand( '${SettlementInfo#Response#$[\'address\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("address", address.toString())

//postalCode
def postalCode = context.expand( '${SettlementInfo#Response#$[\'postalCode\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("postalCode", postalCode.toString())

//clearedBalance
def clearedBalance = context.expand( '${SettlementInfo#Response#$[\'clearedBalance\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("clearedBalance", clearedBalance.toString())

//unEarnedIntRebate
def unEarnedIntRebate = context.expand( '${SettlementInfo#Response#$[\'unEarnedIntRebate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("unEarnedIntRebate", unEarnedIntRebate.toString())

//chequeBalance
def chequeBalance = context.expand( '${SettlementInfo#Response#$[\'chequeBalance\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("chequeBalance", chequeBalance.toString())

//sharedRefund
def sharedRefund = context.expand( '${SettlementInfo#Response#$[\'sharedRefund\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("sharedRefund", sharedRefund.toString())

//sharedIntRefund
def sharedIntRefund = context.expand( '${SettlementInfo#Response#$[\'sharedIntRefund\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("sharedIntRefund", sharedIntRefund.toString())

//accruedInterest
def accruedInterest = context.expand( '${SettlementInfo#Response#$[\'accruedInterest\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accruedInterest", accruedInterest.toString())

//intReliefSubsidy
def intReliefSubsidy = context.expand( '${SettlementInfo#Response#$[\'intReliefSubsidy\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("intReliefSubsidy", intReliefSubsidy.toString())

//inflationAmount
def inflationAmount = context.expand( '${SettlementInfo#Response#$[\'inflationAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("inflationAmount", inflationAmount.toString())

//accruedFees
def accruedFees = context.expand( '${SettlementInfo#Response#$[\'accruedFees\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accruedFees", accruedFees.toString())

//arrrearsPenalty
def arrrearsPenalty = context.expand( '${SettlementInfo#Response#$[\'arrrearsPenalty\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("arrrearsPenalty", arrrearsPenalty.toString())

//miscDebts
def miscDebts = context.expand( '${SettlementInfo#Response#$[\'miscDebts\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("miscDebts", miscDebts.toString())

//dischargeFee
def dischargeFee = context.expand( '${SettlementInfo#Response#$[\'dischargeFee\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeFee", dischargeFee.toString())

//dischargeTax
def dischargeTax = context.expand( '${SettlementInfo#Response#$[\'dischargeTax\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeTax", dischargeTax.toString())

//terminationFee
def terminationFee = context.expand( '${SettlementInfo#Response#$[\'terminationFee\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("terminationFee", terminationFee.toString())

//trmnStartDate
def trmnStartDate = context.expand( '${SettlementInfo#Response#$[\'trmnStartDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("trmnStartDate", trmnStartDate.toString())

//trmnEndDate
def trmnEndDate = context.expand( '${SettlementInfo#Response#$[\'trmnEndDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("trmnEndDate", trmnEndDate.toString())

//currentSettlementAmount
def currentSettlementAmount = context.expand( '${SettlementInfo#Response#$[\'currentSettlementAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("currentSettlementAmount", currentSettlementAmount.toString())

//settlementDate
def settlementDate = context.expand( '${SettlementInfo#Response#$[\'settlementDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("settlementDate", settlementDate.toString())

//maxSettlementAmount
def maxSettlementAmount = context.expand( '${SettlementInfo#Response#$[\'maxSettlementAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("maxSettlementAmount", maxSettlementAmount.toString())

//expiryDate
def expiryDate = context.expand( '${SettlementInfo#Response#$[\'expiryDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("expiryDate", expiryDate.toString())</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasink" name="SettlementInfoSaveResponse" id="ed4820bf-26be-4247-a13f-491d8b0e8068">
    <con:settings/>
    <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSink type="Excel">
        <con:configuration>
          <file/>
          <outfile>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/CloseAF/3.SettlementInfoResults.xlsx</outfile>
          <worksheet>Sheet1</worksheet>
          <cell>E2</cell>
          <evaluateFormulas>false</evaluateFormulas>
          <append>false</append>
        </con:configuration>
      </con:dataSink>
      <con:shared>false</con:shared>
      <con:properties>
        <con:property>
          <con:name>accountNo</con:name>
          <con:value>1688735354</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value>ZAR</con:value>
        </con:property>
        <con:property>
          <con:name>customerNo</con:name>
          <con:value>100016642</con:value>
        </con:property>
        <con:property>
          <con:name>insDescription</con:name>
          <con:value>CAPITEC BANK</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeRef</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>accountName</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>customerName</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>address</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>postalCode</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>clearedBalance</con:name>
          <con:value>169207.0</con:value>
        </con:property>
        <con:property>
          <con:name>unEarnedIntRebate</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>chequeBalance</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>sharedRefund</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>sharedIntRefund</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>accruedInterest</con:name>
          <con:value>694.81</con:value>
        </con:property>
        <con:property>
          <con:name>intReliefSubsidy</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>inflationAmount</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>accruedFees</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>arrrearsPenalty</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>miscDebts</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeTax</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>terminationFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>trmnStartDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>trmnEndDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>currentSettlementAmount</con:name>
          <con:value>169901.81</con:value>
        </con:property>
        <con:property>
          <con:name>settlementDate</con:name>
          <con:value>2020-02-13</con:value>
        </con:property>
        <con:property>
          <con:name>maxSettlementAmount</con:name>
          <con:value>170996.92</con:value>
        </con:property>
        <con:property>
          <con:name>expiryDate</con:name>
          <con:value>2020-02-20</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="CloseProductData" id="3191ba11-8061-4a26-8560-b5c044a9650e">
    <con:settings/>
    <con:config>
      <script>//Get data values
def fromAccount = context.expand( '${Operations(Payment)#Response#$[\'operatableAccount\'][0][\'accountNumber\']}' )
def toAccount = context.expand( '${SettlementInfo#Response#$[\'accountNo\']}' )
def transferAmount = context.expand( '${SettlementInfo#Response#$[\'currentSettlementAmount\']}' )

//Build JSON message
def jsonMessage = '{"fromAccount": "'+fromAccount+'","toAccount": "'+toAccount+'","transferAmount": "'+transferAmount+'" }'

log.info(jsonMessage)
//Create variable 
testRunner.testCase.setPropertyValue( "JSONMessageProperty", jsonMessage )</script>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="CloseProduct" id="f8cf2310-a1b9-44ca-819c-c02ee4fa9738">
    <con:settings/>
    <con:config service="https://onramp-int.int.capinet" resourcePath="/account/closeProduct" methodName="CloseProduct" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="CloseProduct" id="e3e23ea5-7a1a-49fd-ae51-a433b78c894a" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="Authorization" value="${TransferToken#result}"/>
  &lt;con:entry key="sourceSystemIdentifier" value="USSD"/>
&lt;/xml-fragment></con:setting>
        </con:settings>
        <con:endpoint>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility</con:endpoint>
        <con:request>${#TestCase#JSONMessageProperty}</con:request>
        <con:originalUri>https://onramp-int.int.capinet/credit-services/creditproductservice-v1/credit-products/v1/access-facility/transfer</con:originalUri>
        <con:assertion type="JsonPath Existence Match" id="a7d89f4e-100d-4f27-820d-88068a869de3" name="Check for existence of [accountStatus]">
          <con:configuration>
            <path>$['accountStatus']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="abf7f2dd-6773-4eb2-a8cb-3089de7849cc" name="Match content of [accountStatus]">
          <con:configuration>
            <path>$['accountStatus']</path>
            <content>"ACCOUNT_CLOSED"</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters/>
        <con:environmentSpec>
          <con:entry environmentId="abe22d3f-c611-48a2-aa3a-bbb3916687f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="89bfff1c-d314-464e-8dc2-7c368a0011af">
            <con:authProfile>No Authorization</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="CloseProductSinkData" id="3d6fa64c-3769-46ea-8c24-a3841a754a0d">
    <con:settings/>
    <con:config>
      <script>import com.eviware.soapui.support.JsonUtil

//Clear property values in datasink
data = context.testCase.getTestStepByName("SettlementInfoSaveResponse");
String[] propToRemove = new String[data.getPropertyCount()];
propToRemove = data.getPropertyNames();
for ( int i = 0 ; i &lt; propToRemove.size(); i++ ){
    data.removeProperty( propToRemove[i] );
}

//accountNo
def accountNo = context.expand( '${SettlementInfo#Response#$[\'accountNo\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accountNo", accountNo.toString()) 

//currency
def currency = context.expand( '${SettlementInfo#Response#$[\'currency\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("currency", currency.toString())

//customerNo
def customerNo = context.expand( '${SettlementInfo#Response#$[\'customerNo\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("customerNo", customerNo.toString())

//insDescription
def insDescription = context.expand( '${SettlementInfo#Response#$[\'insDescription\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("insDescription", insDescription.toString())

//dischargeRef
def dischargeRef = context.expand( '${SettlementInfo#Response#$[\'dischargeRef\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeRef", dischargeRef.toString())

//accountName
def accountName = context.expand( '${SettlementInfo#Response#$[\'accountName\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accountName", accountName.toString())

//customerName
def customerName = context.expand( '${SettlementInfo#Response#$[\'customerName\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("customerName", customerName.toString())

//address
def address = context.expand( '${SettlementInfo#Response#$[\'address\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("address", address.toString())

//postalCode
def postalCode = context.expand( '${SettlementInfo#Response#$[\'postalCode\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("postalCode", postalCode.toString())

//clearedBalance
def clearedBalance = context.expand( '${SettlementInfo#Response#$[\'clearedBalance\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("clearedBalance", clearedBalance.toString())

//unEarnedIntRebate
def unEarnedIntRebate = context.expand( '${SettlementInfo#Response#$[\'unEarnedIntRebate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("unEarnedIntRebate", unEarnedIntRebate.toString())

//chequeBalance
def chequeBalance = context.expand( '${SettlementInfo#Response#$[\'chequeBalance\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("chequeBalance", chequeBalance.toString())

//sharedRefund
def sharedRefund = context.expand( '${SettlementInfo#Response#$[\'sharedRefund\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("sharedRefund", sharedRefund.toString())

//sharedIntRefund
def sharedIntRefund = context.expand( '${SettlementInfo#Response#$[\'sharedIntRefund\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("sharedIntRefund", sharedIntRefund.toString())

//accruedInterest
def accruedInterest = context.expand( '${SettlementInfo#Response#$[\'accruedInterest\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accruedInterest", accruedInterest.toString())

//intReliefSubsidy
def intReliefSubsidy = context.expand( '${SettlementInfo#Response#$[\'intReliefSubsidy\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("intReliefSubsidy", intReliefSubsidy.toString())

//inflationAmount
def inflationAmount = context.expand( '${SettlementInfo#Response#$[\'inflationAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("inflationAmount", inflationAmount.toString())

//accruedFees
def accruedFees = context.expand( '${SettlementInfo#Response#$[\'accruedFees\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("accruedFees", accruedFees.toString())

//arrrearsPenalty
def arrrearsPenalty = context.expand( '${SettlementInfo#Response#$[\'arrrearsPenalty\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("arrrearsPenalty", arrrearsPenalty.toString())

//miscDebts
def miscDebts = context.expand( '${SettlementInfo#Response#$[\'miscDebts\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("miscDebts", miscDebts.toString())

//dischargeFee
def dischargeFee = context.expand( '${SettlementInfo#Response#$[\'dischargeFee\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeFee", dischargeFee.toString())

//dischargeTax
def dischargeTax = context.expand( '${SettlementInfo#Response#$[\'dischargeTax\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("dischargeTax", dischargeTax.toString())

//terminationFee
def terminationFee = context.expand( '${SettlementInfo#Response#$[\'terminationFee\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("terminationFee", terminationFee.toString())

//trmnStartDate
def trmnStartDate = context.expand( '${SettlementInfo#Response#$[\'trmnStartDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("trmnStartDate", trmnStartDate.toString())

//trmnEndDate
def trmnEndDate = context.expand( '${SettlementInfo#Response#$[\'trmnEndDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("trmnEndDate", trmnEndDate.toString())

//currentSettlementAmount
def currentSettlementAmount = context.expand( '${SettlementInfo#Response#$[\'currentSettlementAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("currentSettlementAmount", currentSettlementAmount.toString())

//settlementDate
def settlementDate = context.expand( '${SettlementInfo#Response#$[\'settlementDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("settlementDate", settlementDate.toString())

//maxSettlementAmount
def maxSettlementAmount = context.expand( '${SettlementInfo#Response#$[\'maxSettlementAmount\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("maxSettlementAmount", maxSettlementAmount.toString())

//expiryDate
def expiryDate = context.expand( '${SettlementInfo#Response#$[\'expiryDate\']}' )
testRunner.testCase.testSteps["SettlementInfoSaveResponse"].setPropertyValue("expiryDate", expiryDate.toString())</script>
    </con:config>
  </con:testStep>
  <con:testStep type="datasink" name="CloseProductSaveResponse" id="cbeb0ef2-c9c2-4eed-8979-10b9fc72f49c">
    <con:settings/>
    <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSink type="Excel">
        <con:configuration>
          <file/>
          <outfile>O:/UAT/Test Automation/CVS New Credit Products/Credit Product Service/CloseAF/4.CloseProductResults.xlsx</outfile>
          <worksheet>Sheet1</worksheet>
          <cell>E2</cell>
          <evaluateFormulas>false</evaluateFormulas>
          <append>false</append>
        </con:configuration>
      </con:dataSink>
      <con:shared>false</con:shared>
      <con:properties>
        <con:property>
          <con:name>accountNo</con:name>
          <con:value>1688735354</con:value>
        </con:property>
        <con:property>
          <con:name>currency</con:name>
          <con:value>ZAR</con:value>
        </con:property>
        <con:property>
          <con:name>customerNo</con:name>
          <con:value>100016642</con:value>
        </con:property>
        <con:property>
          <con:name>insDescription</con:name>
          <con:value>CAPITEC BANK</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeRef</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>accountName</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>customerName</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>address</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>postalCode</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>clearedBalance</con:name>
          <con:value>169207.0</con:value>
        </con:property>
        <con:property>
          <con:name>unEarnedIntRebate</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>chequeBalance</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>sharedRefund</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>sharedIntRefund</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>accruedInterest</con:name>
          <con:value>694.81</con:value>
        </con:property>
        <con:property>
          <con:name>intReliefSubsidy</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>inflationAmount</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>accruedFees</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>arrrearsPenalty</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>miscDebts</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>dischargeTax</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>terminationFee</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>trmnStartDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>trmnEndDate</con:name>
          <con:value>0001-01-01</con:value>
        </con:property>
        <con:property>
          <con:name>currentSettlementAmount</con:name>
          <con:value>169901.81</con:value>
        </con:property>
        <con:property>
          <con:name>settlementDate</con:name>
          <con:value>2020-02-13</con:value>
        </con:property>
        <con:property>
          <con:name>maxSettlementAmount</con:name>
          <con:value>170996.92</con:value>
        </con:property>
        <con:property>
          <con:name>expiryDate</con:name>
          <con:value>2020-02-20</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:properties>
    <con:property>
      <con:name>JSONMessageProperty</con:name>
      <con:value>{"fromAccount": "1110040871","toAccount": "1688735354","transferAmount": "169901.81" }</con:value>
    </con:property>
    <con:property>
      <con:name>URLEncoded</con:name>
      <con:value>grant_type=password&amp;username=CP343094&amp;password=Vadyca!22</con:value>
    </con:property>
  </con:properties>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>56e89502-1c62-469d-a283-4f83298621cb</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>89ad6639-1f6e-4e45-ab46-d924398bd069</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>33308e69-b4ca-4a6d-bcd7-74a8d402e9fa</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>9f4a9659-7e4e-4fe0-a7d0-5e2edfae9487</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>19975a80-74e5-4009-9826-4f8d738926e1</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>0a59a3d4-6b99-4408-9037-aa43ccf97710</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>c850625b-67c0-4e6e-8dc4-662575596654</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>4ac1971a-d702-4bbe-8bd4-929ceb5759ad</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>8abf75f3-3552-4b89-94a4-d860847243ba</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>98e8dce1-8880-4d11-853e-245afe9b92c3</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>50a793df-aa0b-4274-a531-0532bf5048d1</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>dec66e51-0ad6-48aa-b3c2-a9a6db27163c</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>a218e741-964f-4ae9-adf9-923286f617c9</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>1e7a9a56-349a-401e-83a6-573d4effc23e</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>8a4faa10-a600-4a1c-9bb8-63a65e13dc20</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>b98b543c-aa9f-4a9b-8ee7-775ac8c94999</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
